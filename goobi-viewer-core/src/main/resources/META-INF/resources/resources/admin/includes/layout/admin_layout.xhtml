<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"   
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:viewer="http://xmlns.jcp.org/jsf/composite/components/partner"
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:widgetComponent="http://xmlns.jcp.org/jsf/composite/components/widgets"
    xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
    xmlns:adminComponent="http://xmlns.jcp.org/jsf/composite/admin/components"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:p="http://primefaces.org/ui">

    <!-- MESSAGES -->
    <div class="messages">
        <h:messages id="messages" globalOnly="false" infoClass="alert alert-success" errorClass="alert alert-danger" />
    </div>

    <div class="admin">
    	<!-- ADMIN TOPBAR (ACTION MENU) -->
    	<div class="admin__topbar" role="navigation" aria-label="#{msg.aria_label__nav_main}">
    	
    		<div class="admin__topbar-logo-menu -dropdown" aria-label="Topbar logo menu">
    			<div class="admin__topbar-logo" aria-label="Topbar logo">
					<ui:include src="/resources/images/goobi_logo.svg" alt="Goobi Viewer"/>
				</div>
    			<ul class="admin__topbar-dropdown" aria-label="Topbar logo menu dropdown">
	    			<li><a href="https://goobi.io" target="_blank" rel="noopener">#{msg.admin__about_goobi}</a></li>
	    			<li><a href="https://docs.goobi.io/" target="_blank" rel="noopener">#{msg.admin__documentation}</a></li>
	    			<li><a href="https://community.goobi.io/" target="_blank" rel="noopener">#{msg.admin__community}</a></li>
	    			<li><a href="https://github.com/intranda/" target="_blank" rel="noopener">#{msg.admin__sourcecode}</a></li>
	    			<li><a href="https://www.intranda.com/contact/" target="_blank" rel="noopener">#{msg.admin__support}</a></li>
    			</ul>
    		</div>

			<!-- GO TO FRONTEND VIEW -->
            <a class="admin__topbar-view-frontend-link" href="#{request.contextPath}/" title="#{msg.admin__view_frontend}" aria-label="#{msg.admin__view_frontend}">
                <i class="fa fa-home" aria-hidden="true"></i> #{configurationBean.name}
    		</a>

    		<!-- ADD SOMETHING NEW -->
    		<ui:fragment rendered="#{userBean.user.superuser}">
    		<div class="admin__topbar-add -dropdown">
	    		<i class="fa fa-plus" aria-hidden="true"></i><span>#{msg.admin__new}</span>
	   			<ul class="admin__topbar-dropdown">
	    			<li><a href="#{request.contextPath}/admin/cms/pages/templates/" target="_self">#{msg.page}</a></li>
	    			<li><a href="#{request.contextPath}/admin/users/new/" target="_self">#{msg.admin__user}</a></li>
	    			<li><a href="#{request.contextPath}/admin/groups/new/" target="_self">#{msg.admin__group}</a></li>
	    			<li><a href="#{request.contextPath}/admin/ipranges/new/" target="_self">#{msg.admin__ip_range}</a></li>
	    			<li><a href="#{request.contextPath}/admin/rights/new/" target="_self">#{msg.admin__right}</a></li>
	    			<li><a href="#{request.contextPath}/admin/cms/categories/new/" target="_self">#{msg.admin__category}</a></li>
	   			</ul>
    		</div>
    		</ui:fragment>

			<!-- RIGHT AREA TOPBAR -->
			<div class="admin__topbar-right">
	            <!-- CHANGE LANGUAGE -->
				<ui:fragment rendered="#{fn:length(navigationHelper.supportedLanguages) > 1}">
					<div class="admin__topbar-language -dropdown">
						<i class="fa fa-globe" aria-hidden="true"></i><span>#{msg.MD_LANGUAGE}</span>
						<h:form id="changeLocalForm1" prependId="false">
			                <ul class="admin__topbar-dropdown">
			                    <ui:repeat var="lang" value="#{navigationHelper.supportedLanguages}">
			                        <li>
			                             <h:commandLink styleClass="#{navigationHelper.localeString == lang ?'activeLang':''}">
			                                 <h:outputText value="#{msg['changeLocal_long_' += lang]}" />
			                                 <f:setPropertyActionListener target="#{navigationHelper.localeString}" value="#{lang}" />
			                             </h:commandLink>
			                         </li>
			                     </ui:repeat>
			                 </ul>
		                 </h:form>
		            </div>
				</ui:fragment>

	            <!-- LOGOUT -->
	            <div class="admin__topbar-logout">
	                <h:form>
						<h:commandLink styleClass="admin__topbar-logout-link" action="#{userBean.logout}">
						    <span>#{msg.logout}</span>
						    <i class="fa fa-power-off" aria-hidden="true"></i>
						</h:commandLink>
	                </h:form>
	            </div>
            </div>

    	</div>
    	
        <!-- SIDEBAR BACKGROUND -->
        <div class="admin__sidebar-background"></div>

        <!-- SIDEBAR -->
        <aside id="adminSidebar" class="admin__sidebar" aria-label="Admin sidebar">
            <div class="admin__sidebar-inner">
                 <h1>
                        <a href="#{request.contextPath}/admin/"><span>Goobi viewer</span></a>
                </h1>

                <!-- DASHBOARD -->
                <ui:fragment
                    rendered="#{userBean.admin or userBean.user.isHasCmsPrivilege('CMS_PAGES') or crowdsourcingBean.isUserOwnsAnyCampaigns(userBean.user)}">
                    <div class="admin__sidebar-dashboard admin-widget">
                        <div class="admin-widget__header">#{msg.admin__general_title}</div>
                        <ul>
                            <li class="#{navigationHelper.currentPage == 'adminDashboard' ? 'active' : ''}">
                                <a href="#{request.contextPath}/admin/">
                                    <i class="fa fa-tachometer" aria-hidden="true"></i>
                                    <span>#{msg.admin__dashboard}</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </ui:fragment>

                <!-- WIDGETS -->
                <div class="admin__sidebar-widgets">
                    <adminWidget:widget_admin />
                    <adminWidget:widget_crowdsourcing />
                    <adminWidget:widget_cms />
                </div>

            </div>
        </aside>

        <!-- CONTENT BACKGROUND -->
        <div class="admin__content-background"></div>

        <!-- CONTENT -->
        <main id="adminContent" class="admin__content">
            <div class="admin__content-inner">
                <ui:insert name="content" />
            </div>
        </main>
    </div>
</ui:composition>
